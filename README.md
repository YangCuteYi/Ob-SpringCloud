## 1 <font color="#ffc000">单体项目</font>
### 1.1 <font color="#ffc000">什么是单体项目</font>？
指整个项目中所有功能模块都在一个工程中开发，项目部署时需要对所有模块一起编译、打包，并且项目的架构设计、开发模式都非常简单

---
### 1.2 <font color="#ffc000">单体项目的弊端</font>
- **<font color="#ffc000">团队协作成本高</font>**：


> [!info] 
> 在单体项目中，所有的功能模块都在一个工程中，这样会导致开发人员在一个庞大的代码库中进行修改。当多人同时开发时，可能会产生大量的代码冲突，尤其是在处理业务逻辑时。团队成员需要频繁沟通与协调，以确保改动不影响他人的工作，导致协作成本上升


- **<font color="#ffc000">系统发布效率低</font>**：

> [!info] 
> 在单体项目中，当任何一个模块发生变化时，整个系统都需要重新编译、打包和发布。这种“全量发布”方式浪费了大量的时间和资源，尤其是在大型项目中，即使是小的修改也会导致整个系统的重启，影响发布的效率与频率


- **<font color="#ffc000">系统可用性差</font>**：

> [!info] 
> 由于所有的模块都紧密耦合在一起，一个模块出现问题可能会导致整个系统不可用。任何一个模块的失败都会影响到其他模块，进而导致整个系统的宕机，无法进行局部故障隔离


......

为了解决这些弊端，就需要使用 <font color="#ffc000">微服务架构</font> 

---
---

## 2 <font color="#ffc000">微服务架构</font>

### 2.1 <font color="#ffc000">微服务特点</font>

- **<font color="#ffc000">单一职责</font>**：


> [!info] 
> 一个微服务负责一部分业务功能，并且其核心数据不依赖于其它模块


- **<font color="#ffc000">团队自治</font>**：

> [!info] 
> 每个微服务都有自己独立的开发、测试、发布、运维人员，*团队人员规模不超过10人

- **<font color="#ffc000">服务自治</font>**：

> [!info] 
> 每个微服务都独立打包部署，访问自己独立的数据库。并且要做好服务隔离，避免对其它服务产生影响

---

### 2.2 <font color="#ffc000">分布式架构</font>

分布式就是服务拆分的过程，

<font color="#ffc000">微服务架构正是分布式架构的一种最佳实践的方案</font>

---
---

## 3 <font color="#ffc000">服务拆分原则</font>

### 3.1 <font color="#ffc000">什么时候拆分服务？</font>

对于大多数小型项目而言，一般先采取单体架构，随着用户规模扩大、业务复杂之后再逐渐拆分为微服务架构


> [!NOTE] 扩展
> 一般情况下，对于一个初创的项目，首先要做的是验证项目的可行性；
> 因此这一阶段的首要任务是敏捷开发，快速产出生产可用的产品，投入市场做验证；为了达成这一目的，该阶段项目架构往往会比较简单，很多情况下会直接采用单体架构，这样开发成本比较低，可以快速产出结果，一旦发现项目不符合市场，损失较小；如果这一阶段采用复杂的微服务架构，投入大量的人力和时间成本用于架构设计，最终发现产品不符合市场需求，等于全部做了无用功

对于一些大型项目，在立项之初目的就很明确，为了长远考虑，在架构设计时就直接选择微服务架构；虽然前期投入较多，但后期就少了拆分服务的烦恼

---

### 3.2 <font color="#ffc000">怎么拆分服务？</font>
1. <font color="#ffc000">拆分目标</font>
- **<font color="#ffc000">高内聚</font>**：每个微服务的职责要尽量单一，包含的业务相互关联度高、完整度高
- **<font color="#ffc000">低耦合</font>**：每个微服务的功能要相对独立，尽量减少对其它微服务的依赖，或者依赖接口的稳定性要强


> [!NOTE] 扩展
> 高内聚首先是 <font color="#ffc000">单一职责</font> ，但不能说一个微服务就一个接口，而是要保证微服务内部业务的完整性为前提。目标是当我们要修改某个业务时，最好就只修改当前微服务，这样变更的成本更低。
> 
> 一旦微服务做到了高内聚，那么服务之间的 <font color="#ffc000">耦合度</font> 自然就降低了

---

2. <font color="#ffc000">拆分方式</font>

- **<font color="#ffc000">纵向</font>** 拆分


> [!info] 
> 按照项目的功能模块来拆分。例如一般商城系统中，有用户管理功能、订单管理功能、购物车功能、商品管理功能、支付功能等。那么按照功能模块将他们拆分为一个个服务，就属于纵向拆分。*这种拆分模式可以尽可能提高服务的内聚性


- **<font color="#ffc000">横向</font>** 拆分

> [!info] 
> 将各个功能模块之间的公共业务部分，抽取出来作为通用服务
> 
> 例如用户登录是需要发送消息通知，记录风控数据，下单时也要发送短信，记录风控数据。因此消息发送、风控数据记录就是通用的业务功能，因此可以将他们分别抽取为公共服务：消息中心服务、风控管理服务。这样可以提高业务的复用性，避免重复开发。同时通用业务一般接口稳定性较强，也不会使服务之间过分耦合

---

### 3.3 <font color="#ffc000">服务拆分工程结构</font>

 <font color="#ffc000">完全解耦</font>：

> 指每一个微服务都创建为一个独立的工程，甚至可以使用不同的开发语言来开发，项目完全解耦
> 
> - 优点：服务之间耦合度低
> - 缺点：每个项目都有自己的独立仓库，管理麻烦

<font color="#ffc000">Maven聚合</font>：

> 指整个项目为一个 Project ，然后每个微服务是其中的一个 Module 
> 
> - 优点：项目代码集中，管理和运维方便
> - 缺点：服务之间耦合，编译时间相对完全解耦较长
